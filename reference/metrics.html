<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-reference/metrics" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Metrics | Firefox Ecosystem Platform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mozilla.github.io/ecosystem-platform/reference/metrics"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Metrics | Firefox Ecosystem Platform"><meta data-rh="true" name="description" content="Last updated: Oct 6th, 2023"><meta data-rh="true" property="og:description" content="Last updated: Oct 6th, 2023"><link data-rh="true" rel="icon" href="/ecosystem-platform/img/firefox-logo.png"><link data-rh="true" rel="canonical" href="https://mozilla.github.io/ecosystem-platform/reference/metrics"><link data-rh="true" rel="alternate" href="https://mozilla.github.io/ecosystem-platform/reference/metrics" hreflang="en"><link data-rh="true" rel="alternate" href="https://mozilla.github.io/ecosystem-platform/reference/metrics" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://RFM5H13DFK-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Firefox Ecosystem Platform" href="/ecosystem-platform/opensearch.xml"><link rel="stylesheet" href="/ecosystem-platform/assets/css/styles.e5583d03.css">
<script src="/ecosystem-platform/assets/js/runtime~main.5e763506.js" defer="defer"></script>
<script src="/ecosystem-platform/assets/js/main.4c890bc1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ecosystem-platform/"><div class="navbar__logo"><img src="/ecosystem-platform/img/firefox-logo.png" alt="Ecosystem Platform Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ecosystem-platform/img/firefox-logo.png" alt="Ecosystem Platform Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Firefox Ecosystem Platform</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mozilla/ecosystem-platform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ecosystem-platform/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">For Relying Parties</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/relying-parties/tutorials/integration-with-fxa">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/relying-parties/how-tos/end-to-end-encryption">How-to Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/relying-parties/reference/integration-requirements">Reference</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">For FxA Engineers</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/tutorials/development-setup">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/how-tos/ci-guidelines">How-to Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/ecosystem-platform/reference/team-processes/development-process">Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/reference/team-processes/development-process">Team Processes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/reference/style-guides/node-style-guide">Style Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/reference/tests-in-circleci">CI and Test Automation</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/application-logging">Application Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/application-tracing">Application Tracing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/browser-support">Browser Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/canceling-subscriptions-to-plan">Canceling Subscriptions to Plan</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/customs-api">⚙️ Customs API Reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/database-structure">Database Structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/emails">Emails</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/experiments-ab-testing">Experiments &amp; A/B Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/github-strategies">GitHub Strategies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/incident-response">Incident Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/localization">Localization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ecosystem-platform/reference/metrics">Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/mobile-specifics">Mobile Specifics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/npm-scripts-and-nx">NPM / NX Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/oauth-details">OAuth Details</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/rate-limiting">Rate limiting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/storybook-deploys-with-circleci">Storybook Deploys with CircleCI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/system-diagrams">System Diagrams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/third-party-authentication">Third Party Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/tokens">Tokens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/reference/webchannels">WebChannels</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a href="https://docs.telemetry.mozilla.org/datasets/fxa.html" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">Telemetry Data Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/explanation/architectural-decision-records">Explanation</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/additional-docs">Additional Docs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">For Support Agents</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/reference/admin-panel">Reference</a></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ecosystem-platform/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">For FxA Engineers</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Reference</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Metrics</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Metrics</h1></header><p>Last updated: <code>Oct 6th, 2023</code></p>
<p>Mozilla accounts collects metrics from servers running our code and clients accessing our services.  Mozilla takes data collection seriously so our policies and processes around it may seem more complex than most organizations but it is in an effort to grant agency to users over their own data.</p>
<p>Note that the <a href="https://wiki.mozilla.org/Data_Collection" target="_blank" rel="noopener noreferrer">Mozilla Data Collection policies</a> apply to Mozilla accounts.</p>
<p>Our code is deployed to a staging environment before it goes to production so the metrics detailed below are available for both environments.  The details below will focus mostly on production.</p>
<p>Keep in mind that Mozilla accounts allows users to opt-out of data collection via a toggle on the account settings page.</p>
<p>We also have a <a href="/ecosystem-platform/explanation/metrics">metrics section which expands on the history of our system and how these are implemented</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="application-metrics">Application metrics<a href="#application-metrics" class="hash-link" aria-label="Direct link to Application metrics" title="Direct link to Application metrics">​</a></h2>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This is all undergoing major changes now with the move to GCP as well as FxA&#x27;s migration to using Glean.  Hopefully we can remove this message in 2024 and simplify these docs, though it is unclear if/when SubPlat will migrate to using Glean.</p></div></div>
<p>These are logs from Mozilla accounts code.  These are probably the most useful logs for product decision making as they were written by hand by engineers.  They are also the most complex.</p>
<ul>
<li>Example data recorded<!-- -->
<ul>
<li>See the <a href="https://docs.telemetry.mozilla.org/datasets/fxa.html" target="_blank" rel="noopener noreferrer">taxonomies in the Mozilla Data Docs</a>.</li>
<li>As we move to Glean the dictionaries here will remain up to date automatically:  <a href="https://dictionary.telemetry.mozilla.org/apps/accounts_frontend" target="_blank" rel="noopener noreferrer">Frontend</a> and <a href="https://dictionary.telemetry.mozilla.org/apps/accounts_backend" target="_blank" rel="noopener noreferrer">Backend</a></li>
</ul>
</li>
<li>Recorded with<!-- -->
<ul>
<li>
<p>These are logged via <a href="https://github.com/mozilla/mozlog/" target="_blank" rel="noopener noreferrer">mozlog</a> as regular server logs.</p>
</li>
<li>
<p>The logs are immediately ingested into <a href="https://cloud.google.com/logging" target="_blank" rel="noopener noreferrer">GCP Cloud Logging</a></p>
</li>
<li>
<p>From there they are passed and stored in BigQuery in the <code>moz-fx-fxa-prod.gke-fx-fxa-prod</code> or <code>moz-fx-fxa-nonprod.gke-fx-fxa-stage</code> projects depending on which environment they are coming out of.  These projects are relatively restricted and not for general consumption.</p>
</li>
<li>
<p>Every 24 hours, <a href="https://github.com/mozilla/bigquery-etl/tree/main/sql/moz-fx-data-shared-prod/firefox_accounts_derived" target="_blank" rel="noopener noreferrer">some ETL jobs</a> run which create derived tables from the original logs and store them in the <code>mozdata</code> project in BigQuery.  <code>mozdata</code> is accessible by anyone at Mozilla.  Please note: <em>Derived tables do not include all the events or details in the original logs.  You can read the queries that create the derived tables to see what is included.</em></p>
</li>
<li>
<p>Additionally, there are some <a href="https://github.com/mozilla/bigquery-etl/tree/main/sql/moz-fx-data-shared-prod/firefox_accounts" target="_blank" rel="noopener noreferrer">user-facing datasets</a> of that same data, and also in <code>mozdata</code>, which are designed to be easier to use.</p>
</li>
</ul>
</li>
<li>Accessible via<!-- -->
<ul>
<li><a href="https://console.cloud.google.com/bigquery?" target="_blank" rel="noopener noreferrer">BigQuery</a>.  Look for the <code>firefox_accounts</code> dataset in the <code>mozdata</code> project.  <em>Be aware that there are large amounts of data in BigQuery and you can spend a lot of money if you don&#x27;t restrict your queries.</em></li>
<li>Looker is backed by BigQuery and there is a <a href="https://mozilla.cloud.looker.com/folders/374" target="_blank" rel="noopener noreferrer">Mozilla accounts folder</a> there.<!-- -->
<ul>
<li>Subscription Platform dashboards are located in the <a href="https://mozilla.cloud.looker.com/folders/1355" target="_blank" rel="noopener noreferrer">Subscription Platform folder</a>. See also <a href="#subscription-product-metrics">Subscription product metrics</a>.</li>
</ul>
</li>
<li>There are <a href="https://earthangel-b40313e5.influxcloud.net/?orgId=1&amp;search=open&amp;query=fxa" target="_blank" rel="noopener noreferrer">several dashboards in grafana</a> with a mix of these metrics on them</li>
<li>See the section below about raw logs also</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-raw-logs">Working with Raw Logs<a href="#working-with-raw-logs" class="hash-link" aria-label="Direct link to Working with Raw Logs" title="Direct link to Working with Raw Logs">​</a></h3>
<p>If you need real-time data you need to be looking at the raw logs in <code>moz-fx-fxa-prod.gke-fx-fxa-prod</code> or <code>moz-fx-fxa-nonprod.gke-fx-fxa-stage</code>.  Otherwise there will be a 24 hour delay.  We don&#x27;t run our normal metrics out of those logs because it is too expensive and slow.</p>
<p>As noted above, these datasets are restricted but if you have access you&#x27;ll find each package logging to those datasets in either the <code>stderr</code> or <code>stdout</code> tables.  You can (and should) filter your queries by the package.  For example, to only look at logs from <code>fxa-customs-server</code> we would filter where <code>labels.k8s_pod_deployment=&quot;customs&quot; AND resource.labels.container_name=&quot;customs&quot;</code>.  This will capture the pod name and the container name.  We need to filter on both because each pod runs the package as well as nginx.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="crashes">Crashes<a href="#crashes" class="hash-link" aria-label="Direct link to Crashes" title="Direct link to Crashes">​</a></h2>
<ul>
<li>Example data recorded:<!-- -->
<ul>
<li><code>t is undefined</code> and a link to the JS that failed to run</li>
<li><code>An internal validation check failed.</code> and details about what the software expected to see and what it actually saw</li>
</ul>
</li>
<li>Recorded with<!-- -->
<ul>
<li>Sentry</li>
</ul>
</li>
<li>Accessible via<!-- -->
<ul>
<li><a href="https://sentry.prod.mozaws.net/operations/" target="_blank" rel="noopener noreferrer">Sentry</a></li>
<li>Look for any project starting with <code>fxa-</code>.  Eg. <code>fxa-auth-prod</code> and <code>fxa-content-client-prod</code></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="server-health">Server Health<a href="#server-health" class="hash-link" aria-label="Direct link to Server Health" title="Direct link to Server Health">​</a></h2>
<ul>
<li>Example data recorded<!-- -->
<ul>
<li>There are 30 healthy hosts running</li>
<li>A host is running at 100% cpu</li>
</ul>
</li>
<li>Recorded with<!-- -->
<ul>
<li>The reporting tools built into the clouds we use</li>
</ul>
</li>
<li>Accessible via<!-- -->
<ul>
<li>In their most detailed form, you&#x27;d need access to the cloud consoles themselves, but most of the data is also available in our Grafana instance.  <a href="https://earthangel-b40313e5.influxcloud.net/d/HqOQKXoZk/fxa-auth-prod-elb?orgId=1" target="_blank" rel="noopener noreferrer">Here is one of our dashboards hitting CloudWatch for metrics</a></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="front-end-performance">Front-end Performance<a href="#front-end-performance" class="hash-link" aria-label="Direct link to Front-end Performance" title="Direct link to Front-end Performance">​</a></h2>
<ul>
<li>Example data recorded<!-- -->
<ul>
<li>It took 400ms to load <code>/settings</code></li>
</ul>
</li>
<li>Recorded with<!-- -->
<ul>
<li>As of this writing we record the data using our own library (which maybe isn&#x27;t totally accurate) and write the data via <code>statsd</code> which ends up in influxdb.  We expect to move to <a href="https://sentry.io/for/performance/" target="_blank" rel="noopener noreferrer">Sentry Performance</a> soon</li>
</ul>
</li>
<li>Accessible via<!-- -->
<ul>
<li>Look for the <code>svcops_aws</code> project in Grafana.  <a href="https://earthangel-b40313e5.influxcloud.net/d/1tthDDrWk/content-server?orgId=1" target="_blank" rel="noopener noreferrer">Here is a dashboard with some examples</a></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="subscription-product-metrics">Subscription product metrics<a href="#subscription-product-metrics" class="hash-link" aria-label="Direct link to Subscription product metrics" title="Direct link to Subscription product metrics">​</a></h2>
<p>These are a combination of <a href="#application-metrics">application metrics</a> and metrics more directly from subscription providers like Stripe, Apple and Google to answer product questions as initially specified by the <a href="https://docs.google.com/document/d/1AL8BSlHuxABypDdQSoaiMuo6H1pmintj1Loh6oesxZU/edit?usp=sharing" target="_blank" rel="noopener noreferrer">PRD</a> and <a href="https://docs.google.com/document/d/1-KdXzZbn3Utw2aekJbcc1lrMV9tNb19tzifPbdtQaso/edit?usp=sharing" target="_blank" rel="noopener noreferrer">Technical Specification</a> for <a href="https://mozilla-hub.atlassian.net/browse/FXA-6556" target="_blank" rel="noopener noreferrer">FXA-6556</a>.</p>
<p>For high level information from the RP perspective, see <a href="/ecosystem-platform/relying-parties/how-tos/product-metrics">Metrics for Relying Parties</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="looker">Looker<a href="#looker" class="hash-link" aria-label="Direct link to Looker" title="Direct link to Looker">​</a></h3>
<p><a href="https://mozilla.cloud.looker.com" target="_blank" rel="noopener noreferrer">Looker</a> is the business intelligence tool Mozilla uses to report on product metrics, and we have SubPlat dashboards there based on Logical Subscription(s) and All Event Counts explores created and maintained by our data engineering team.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="dashboards">Dashboards<a href="#dashboards" class="hash-link" aria-label="Direct link to Dashboards" title="Direct link to Dashboards">​</a></h4>
<p>Anyone at Mozilla can view the SubPlat Looker dashboards, which are in the <a href="https://mozilla.cloud.looker.com/folders/1355" target="_blank" rel="noopener noreferrer">Subscription Platform</a> folder and include:</p>
<ul>
<li><a href="https://mozilla.cloud.looker.com/dashboards/1329" target="_blank" rel="noopener noreferrer">SubPlat Subscriptions</a></li>
<li><a href="https://mozilla.cloud.looker.com/dashboards/1371" target="_blank" rel="noopener noreferrer">SubPlat Checkout</a></li>
</ul>
<p>To obtain edit access, ask SubPlat&#x27;s engineering manager to request it in the <a href="https://app.slack.com/client/T027LFU12/C4D5ZA91B" target="_blank" rel="noopener noreferrer"><code>#data-help</code> Slack channel</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="subscription-platform--logical-subscriptions-explores">Subscription Platform &gt; Logical Subscription(s) explores<a href="#subscription-platform--logical-subscriptions-explores" class="hash-link" aria-label="Direct link to Subscription Platform &gt; Logical Subscription(s) explores" title="Direct link to Subscription Platform &gt; Logical Subscription(s) explores">​</a></h4>
<p>There are currently four Logical Subscription(s) explores:</p>
<ul>
<li><a href="https://mozilla.cloud.looker.com/explore/subscription_platform/daily_active_logical_subscriptions" target="_blank" rel="noopener noreferrer">Daily Active Logical Subscriptions</a>
<ul>
<li>Represents all the subscriptions that were active at any point on a certain date.</li>
</ul>
</li>
<li><a href="https://mozilla.cloud.looker.com/explore/subscription_platform/monthly_active_logical_subscriptions" target="_blank" rel="noopener noreferrer">Monthly Active Logical Subscriptions</a>
<ul>
<li>Represents all the subscriptions that were active at any point during a certain month.</li>
</ul>
</li>
<li><a href="https://mozilla.cloud.looker.com/explore/subscription_platform/logical_subscription_events" target="_blank" rel="noopener noreferrer">Logical Subscription Events</a>
<ul>
<li>Represents changes we see to a subscription over time, i.e. lifecycle events such as start, end, cancel or plan change.</li>
</ul>
</li>
<li><a href="https://mozilla.cloud.looker.com/explore/subscription_platform/logical_subscriptions" target="_blank" rel="noopener noreferrer">Logical Subscriptions</a>
<ul>
<li>Represents the current state of subscriptions, including all subscriptions that have ended.</li>
</ul>
</li>
</ul>
<p>Data sources for these explores are described in <a href="/ecosystem-platform/relying-parties/reference/metrics-for-relying-parties">Metrics for Relying Parties</a>.</p>
<p>More information can be found in the <a href="https://docs.google.com/document/d/13TgTN7UJ_89dhh0S64eh0oDsYNHPdeJyEmLk0uScoGI/edit?usp=sharing" target="_blank" rel="noopener noreferrer">SubPlat consolidated reporting ETL design document</a> and from these <a href="https://docs.google.com/document/d/1-K9TtkKHezL-Xo6LcGxd866TkAaeRzQqdXNx9PJQnNE/edit#bookmark=id.7eo8irobcj0k" target="_blank" rel="noopener noreferrer">walkthrough notes</a>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Logical subscriptions reflect one subscription per Stripe subscription item. So if a single Stripe subscription has two subscription items, this would be two separate logical subscriptions in these explores. This is in anticipation of potential support in the future for consolidated billing where each subscription item is effectively a separate subscription billed with a single invoice.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mozilla-accounts--all-event-counts-explores">Mozilla accounts &gt; All Event Counts explores<a href="#mozilla-accounts--all-event-counts-explores" class="hash-link" aria-label="Direct link to Mozilla accounts &gt; All Event Counts explores" title="Direct link to Mozilla accounts &gt; All Event Counts explores">​</a></h4>
<p>These data are events pulled out of FxA application logs (see <a href="#application-metrics">Application metrics</a>). There is currently one explore that we use for the SubPlat dashboard: <a href="https://mozilla.cloud.looker.com/explore/firefox_accounts/all_event_counts" target="_blank" rel="noopener noreferrer">All Event Counts</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-inspect-the-underlying-data-from-an-explore-or-look">How to inspect the underlying data from an explore or look<a href="#how-to-inspect-the-underlying-data-from-an-explore-or-look" class="hash-link" aria-label="Direct link to How to inspect the underlying data from an explore or look" title="Direct link to How to inspect the underlying data from an explore or look">​</a></h4>
<p>As explained in <a href="#application-metrics">Application metrics</a>, the data for these explores comes from ETL jobs where data exists in various tables in BigQuery. Here&#x27;s how you can find out more information about a particular dimension in a Looker Look or Explore.</p>
<ol>
<li>Find the Look or Explore you want to inspect in Looker. For a Look in a dashboard, click &quot;Explore from here&quot; from the Look&#x27;s overflow menu. E.g. navigate to the <a href="https://mozilla.cloud.looker.com/explore/subscription_platform/monthly_active_logical_subscriptions" target="_blank" rel="noopener noreferrer">Monthly Active Logical Subscriptions</a> explore.</li>
<li>In the Explore view in Looker, in the left sidebar, hover over the dimension of interest (e.g. Monthly Active Logical Subscriptions &gt; Subscription &gt; Auto Renew) and click the Info icon, then click &quot;Go to LookML&quot;.</li>
<li>You&#x27;ll be brought to a new page displaying the <code>view</code> file. Here you can inspect which table the data came from in the <code>mozdata</code> GCP project. Often this can be found by searching for <code>sql_table_name</code>. E.g. <code>mozdata.subscription_platform.monthly_active_logical_subscriptions</code>.</li>
<li>Now you have one of two choices, though the easiest is likely to search the data catalog (<a href="https://mozilla.acryl.io/" target="_blank" rel="noopener noreferrer">Acryl</a>) for this dataset by name. The dot notation indicates the namespaces you&#x27;ll find the table under, with the last value being the table name (e.g. <code>monthly_active_logical_subscriptions</code>).<!-- -->
<ul>
<li>Search for the table name in Acryl.<!-- -->
<ul>
<li>Select the Datasets &gt; BigQuery &gt; <code>mozdata</code> &gt; <code>subscription_platform</code> result. <code>mozdata</code> is a GCP project in BigQuery with metrics for lots of Mozilla products and services.</li>
</ul>
</li>
<li>Click the &quot;Lineage&quot; tab</li>
<li>Click &quot;Visualize Lineage&quot;</li>
<li>Continue to click the <code>+</code> icons to the left of the table in question to find upstream tables, until you reach the origin table.</li>
</ul>
</li>
<li>As we can see from the diagram below, we may find how this dimension is set from the <code>stripe_logical_subscriptions_history_v1</code> table. Looking <a href="https://github.com/mozilla/bigquery-etl/blob/de71eac14d195c5abaf62abd485f2e0a0ca9c75a/sql/moz-fx-data-shared-prod/subscription_platform_derived/stripe_logical_subscriptions_history_v1/query.sql#L185" target="_blank" rel="noopener noreferrer">that table up in the <code>bigquery-etl</code> repo</a>, we can confirm this.</li>
</ol>
<p><img loading="lazy" src="/ecosystem-platform/assets/images/data_catalog_example-56db3387e4ea06655e30f5bd3019c9aa.png" width="3426" height="1954" class="img_ev3q"></p>
<p>The other option is to search for the queries (i.e. <code>query.sql</code> files) that create these tables in the <a href="https://github.com/mozilla/bigquery-etl/" target="_blank" rel="noopener noreferrer"><code>bigquery-etl</code> repo</a> with a series of reverse look-ups.</p>
<ol>
<li>Search for the table name (e.g. <code>monthly_active_logical_subscriptions</code>)</li>
<li><code>moz-fx-data-shared-prod.subscription_platform.monthly_active_logical_subscriptions</code> pulls from:</li>
<li><code>moz-fx-data-shared-prod.subscription_platform_derived.monthly_active_logical_subscriptions_v1</code> pulls from:</li>
<li><code>moz-fx-data-shared-prod.subscription_platform_derived.daily_active_logical_subscriptions_v1</code> pulls from:</li>
<li><code>moz-fx-data-shared-prod.subscription_platform_derived.logical_subscriptions_history_v1</code> pulls from:</li>
<li><code>moz-fx-data-shared-prod.subscription_platform_derived.stripe_logical_subscriptions_history_v1</code> pulls from:</li>
<li>Finally! <a href="https://github.com/mozilla/bigquery-etl/blob/de71eac14d195c5abaf62abd485f2e0a0ca9c75a/sql/moz-fx-data-shared-prod/subscription_platform_derived/stripe_logical_subscriptions_history_v1/query.sql#L185" target="_blank" rel="noopener noreferrer">We&#x27;ve found how this dimension is set</a> from the table in the previous step.</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>A given query can pull from multiple tables, so the lineage for a given table is not necessarily linear and more likely branches. See example lineage from the data catalog image above.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/mozilla/ecosystem-platform/edit/master/docs/reference/metrics.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ecosystem-platform/reference/localization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Localization</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ecosystem-platform/reference/mobile-specifics"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Mobile Specifics</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#application-metrics" class="table-of-contents__link toc-highlight">Application metrics</a><ul><li><a href="#working-with-raw-logs" class="table-of-contents__link toc-highlight">Working with Raw Logs</a></li></ul></li><li><a href="#crashes" class="table-of-contents__link toc-highlight">Crashes</a></li><li><a href="#server-health" class="table-of-contents__link toc-highlight">Server Health</a></li><li><a href="#front-end-performance" class="table-of-contents__link toc-highlight">Front-end Performance</a></li><li><a href="#subscription-product-metrics" class="table-of-contents__link toc-highlight">Subscription product metrics</a><ul><li><a href="#looker" class="table-of-contents__link toc-highlight">Looker</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Mozilla Corporation.</div></div></div></footer></div>
</body>
</html>