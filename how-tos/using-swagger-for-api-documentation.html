<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-how-tos/using-swagger-for-api-documentation">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Using Swagger for API documentation | Firefox Ecosystem Platform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mozilla.github.io/ecosystem-platform/how-tos/using-swagger-for-api-documentation"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Using Swagger for API documentation | Firefox Ecosystem Platform"><meta data-rh="true" name="description" content="Last updated: May 2022"><meta data-rh="true" property="og:description" content="Last updated: May 2022"><link data-rh="true" rel="icon" href="/ecosystem-platform/img/firefox-logo.png"><link data-rh="true" rel="canonical" href="https://mozilla.github.io/ecosystem-platform/how-tos/using-swagger-for-api-documentation"><link data-rh="true" rel="alternate" href="https://mozilla.github.io/ecosystem-platform/how-tos/using-swagger-for-api-documentation" hreflang="en"><link data-rh="true" rel="alternate" href="https://mozilla.github.io/ecosystem-platform/how-tos/using-swagger-for-api-documentation" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://RFM5H13DFK-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Firefox Ecosystem Platform" href="/ecosystem-platform/opensearch.xml"><link rel="stylesheet" href="/ecosystem-platform/assets/css/styles.c7edb04e.css">
<link rel="preload" href="/ecosystem-platform/assets/js/runtime~main.2ebd4c4c.js" as="script">
<link rel="preload" href="/ecosystem-platform/assets/js/main.87e8bd90.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ecosystem-platform/"><div class="navbar__logo"><img src="/ecosystem-platform/img/firefox-logo.png" alt="Ecosystem Platform Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/ecosystem-platform/img/firefox-logo.png" alt="Ecosystem Platform Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Firefox Ecosystem Platform</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mozilla/ecosystem-platform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ecosystem-platform/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">For Relying Parties</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/relying-parties/tutorials/integration-with-fxa">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/relying-parties/how-tos/end-to-end-encryption">How-to Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/relying-parties/reference/integration-requirements">Reference</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">For FxA Engineers</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/tutorials/development-setup">Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/ecosystem-platform/how-tos/ci-guidelines">How-to Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/ci-guidelines">CI Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/connecting-to-a-local-mysql-db">Connecting to a local MySQL DB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/creating-an-account-locally">Creating an Account Locally</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/local-emails-with-maildev">Local Emails with MailDev</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/managing-yarn-dependencies">Managing Yarn Dependencies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/node-debugging">Node Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/using-a-custom-profile-with-firefox">Using a Custom Profile with Firefox</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/using-sentry-locally">Using Sentry.io for Local Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ecosystem-platform/how-tos/using-swagger-for-api-documentation">Using Swagger for API documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/using-tracing-in-gcp">Tracing for Stage/Prod</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/using-tracing-locally">Tracing for Local Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/using-vscode-with-fxa">Using VS Code with FxA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/how-tos/working-with-metrics">Working with Metrics</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/reference/team-processes/development-process">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/explanation/architectural-decision-records">Explanation</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ecosystem-platform/additional-docs">Additional Docs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">For Support Agents</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/ecosystem-platform/reference/admin-panel">Reference</a></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ecosystem-platform/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">For FxA Engineers</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">How-to Guides</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Using Swagger for API documentation</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using Swagger for API documentation</h1></header><p>Last updated: May 2022</p><p>We currently utilize Swagger, specifically the <a href="https://github.com/glennjones/hapi-swagger" target="_blank" rel="noopener noreferrer">hapi-swagger</a> plug-in, to autogenerate a JSON file (e.g., <code>https://api.accounts.firefox.com/swagger.json</code>) that includes details of the available API endpoints, operations on each endpoint, input and output parameters for each operation, authentication methods, and other information. This JSON file is then rendered with <a href="https://github.com/rohit-gohri/redocusaurus" target="_blank" rel="noopener noreferrer">redocusaurus</a> to display our API documentation in the Firefox Ecosystem Platform.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting Started<a href="#getting-started" class="hash-link" aria-label="Direct link to Getting Started" title="Direct link to Getting Started">​</a></h2><p>Add the following code to create a Hapi <code>server</code> object.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">const Hapi = require(&#x27;@hapi/hapi&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const HapiSwagger = require(&#x27;hapi-swagger&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const Pack = require(&#x27;./package&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(async () =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const server = await new Hapi.Server({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        host: &#x27;localhost&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 3000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const swaggerOptions = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        info: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                title: &#x27;Test API Documentation&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                version: Pack.version,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    await server.register([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            plugin: HapiSwagger,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            options: swaggerOptions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        await server.start();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(&#x27;Server running at:&#x27;, server.info.uri);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } catch(err) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        console.log(err);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server.route(Routes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Source: <a href="https://github.com/glennjones/hapi-swagger#quick-start" target="_blank" rel="noopener noreferrer">Quick start | hapi-swagger</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-view-locally">How to view locally<a href="#how-to-view-locally" class="hash-link" aria-label="Direct link to How to view locally" title="Direct link to How to view locally">​</a></h2><p>To view the hapi-swagger generated JSON file locally:</p><ul><li><code>npm start</code> on <code>fxa-auth-server</code></li><li>Go to <a href="http://localhost:9000/swagger.json" target="_blank" rel="noopener noreferrer">localhost:9000/swagger.json</a></li></ul><p>To view the API documentation within Ecosystem Platform locally:</p><ul><li><code>yarn start</code> the <a href="https://github.com/mozilla/ecosystem-platform" target="_blank" rel="noopener noreferrer">Ecosystem Platform</a> repository</li><li>Go to <a href="http://localhost:3000/ecosystem-platform/api" target="_blank" rel="noopener noreferrer">localhost:3000/ecosystem-platform/api</a></li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>If you are modifying the Swagger JSON file and want to view the API documentation locally, temporarily use the Swagger JSON file (e.g., <code>http://localhost:9000/swagger.json</code>) in the specs array within <code>docusaurus.config.js</code></p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-documentation">API documentation<a href="#api-documentation" class="hash-link" aria-label="Direct link to API documentation" title="Direct link to API documentation">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tags">Tags<a href="#tags" class="hash-link" aria-label="Direct link to Tags" title="Direct link to Tags">​</a></h3><p>The available sections of our API documentation (e.g., &#x27;Account&#x27;, &#x27;Devices and Sessions&#x27;, &#x27;Subscriptions&#x27;, etc.) are designated by the <code>tags</code> property in each operation on an endpoint. Existing sections and their tags can be found in <code>fxa-auth-server/docs/swagger/swagger-tags.ts</code>. This file ensures there are no duplicate or mislabeled sections/tags (e.g. &#x27;Device and Sessions&#x27; vs. &#x27;Devices and Sessions&#x27;); it will be later referenced within each <a href="#api-documentation-file">API documentation file</a>, which you can proceed to if you are modifying the API documentation and the section or tag already exists. If it doesn&#x27;t, create and save new tags to the <code>TAGS</code> object.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Be sure to include <code>&#x27;api&#x27;</code> in the tag&#x27;s array for it to appear in the documentation.</p></div></div><p>If you have created a new tag, you will also need to add it in the array of the API doc it is to appear under in <code>fxa-auth-server/docs/swagger/swagger-options.ts</code>. If the tag includes a description, add the tag object to the <code>tags</code> property as well. While <code>name</code> is the only required property in a tag&#x27;s object, other properties include <code>description</code> and <code>externalDocs</code>. See <a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/2.0.md#tag-object" target="_blank" rel="noopener noreferrer">Tag Object</a> for more information.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-documentation-file">API documentation file<a href="#api-documentation-file" class="hash-link" aria-label="Direct link to API documentation file" title="Direct link to API documentation file">​</a></h3><p>Each tag has an API documentation file that can be found through <code>fxa-auth-server/docs/swagger</code>. If you created a new tag, create its corresponding API documentation file - please follow the naming convention <code>&lt;TAG&gt;-api.ts</code> (e.g. <code>account-api.ts</code>, <code>subscriptions-api.ts</code>).</p><p>Within an API documentation file, there is a route object for each operation of an endpoint. Our naming convention for the variable of a route object typically includes the endpoint and its method (e.g., <code>ACCOUNT_CREATE_POST</code> is for <code>POST /account/create</code>). At the very least, each route object requires <code>description</code> and <code>tags</code> properties. The description is what will appear within the sidebar of the API documentation (e.g., <code>/account/create</code>). The tag is the section that the endpoint will appear under.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>An operation of an endpoint can be included in multiple sections within our API documentation by modifying the <code>tags</code> property to reflect all of the sections it should be included in (e.g., <code>tags: [&#x27;api&#x27;, &#x27;Account&#x27;, &#x27;Subscriptions&#x27;]</code>).</p></div></div><p>Any details regarding the operation are included within a <code>notes</code> array property; the <code>dedent</code> dependency is utilized for multi-line strings. Response errors, if any, are included within a <code>plugins[&#x27;hapi-swagger&#x27;].responses</code> object (see example below).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// account-api.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import TAGS from &#x27;./swagger-tags&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const TAGS_ACCOUNT = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tags: TAGS.ACCOUNT,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const ACCOUNT_CREATE_POST = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...TAGS_ACCOUNT,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  description: &#x27;/account/create&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  notes: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dedent`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Creates a user account. The client provides the email address with which this account will be associated and a stretched password. Stretching is detailed on the [**onepw**](https://github.com/mozilla/fxa-auth-server/wiki/onepw-protocol#creating-the-account) wiki page.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      This endpoint may send a verification email to the user. Callers may optionally provide the \`service\` parameter to indicate which service they are acting on behalf of. This is an opaque alphanumeric token that will be embedded in the verification link as a query parameter.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Creating an account also logs in. The response contains a \`sessionToken\` and, optionally, a \`keyFetchToken\` if the url has a query parameter of \`keys=true\`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  `,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plugins: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;hapi-swagger&#x27;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      responses: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        400: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          description: dedent`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Failing requests may be caused by the following errors (this is not an exhaustive list):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            \`errno: 101\` - Account already exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            \`errno: 144\` - Email already exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          `,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Caption: Example of a route object</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="adding-api-documentation-to-its-route">Adding API documentation to its route<a href="#adding-api-documentation-to-its-route" class="hash-link" aria-label="Direct link to Adding API documentation to its route" title="Direct link to Adding API documentation to its route">​</a></h3><p>Once a route object is properly created in an API documentation file, it can be simply added to its appropriate route. See example below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// routes/account.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import ACCOUNT_DOCS from &#x27;../../docs/swagger/account-api&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    method: &#x27;POST&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path: &#x27;/account/create&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...ACCOUNT_DOCS.ACCOUNT_CREATE_POST, // &lt;-- API DOCUMENTATION FILE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        validate: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          query: isA.object({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keys: isA.boolean().optional().description(DESCRIPTION.keys),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            service: validators.service.description(DESCRIPTION.service),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          payload: isA.object({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            email: validators.email().required().description(DESCRIPTION.email),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            authPW: validators.authPW.description(DESCRIPTION.authPW),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            service: validators.service.description(DESCRIPTION.service),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            redirectTo: validators</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .redirectTo(config.smtp.redirectDomain)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .optional()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .description(DESCRIPTION.redirectTo),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            resume: isA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .string()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .max(2048)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .optional()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              .description(DESCRIPTION.resume),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            metricsContext: METRICS_CONTEXT_SCHEMA,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            style: isA.string().allow([&#x27;trailhead&#x27;]).optional(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            verificationMethod: validators.verificationMethod.optional(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // preVerified is not available in production mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ...(!(config as any).isProduction &amp;&amp; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              preVerified: isA.boolean(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          schema: isA.object({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            uid: isA.string().regex(HEX_STRING).required(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sessionToken: isA.string().regex(HEX_STRING).required(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            keyFetchToken: isA.string().regex(HEX_STRING).optional(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            authAt: isA.number().integer().description(DESCRIPTION.authAt),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            verificationMethod: validators.verificationMethod.optional(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    handler: (request: AuthRequest) =&gt; accountHandler.accountCreate(request),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">},</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Caption: Example of a route</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-information">Other information<a href="#other-information" class="hash-link" aria-label="Direct link to Other information" title="Direct link to Other information">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="descriptions">Descriptions<a href="#descriptions" class="hash-link" aria-label="Direct link to Descriptions" title="Direct link to Descriptions">​</a></h3><p>There is a glossary of descriptions that can be found in <code>fxa-auth-server/docs/swagger/shared/descriptions.ts</code>. As opposed to the required descriptions mentioned for the route object, these descriptions are optionally used to provide more details about the parameters used within a payload, query, schema, etc. This file helps eliminate repetitive descriptions and declutters the route files.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import DESCRIPTION from &#x27;../../docs/swagger/shared/descriptions&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keys: isA.boolean().optional().description(DESCRIPTION.keys),</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="hapi-swagger-documentation">Hapi-swagger documentation<a href="#hapi-swagger-documentation" class="hash-link" aria-label="Direct link to Hapi-swagger documentation" title="Direct link to Hapi-swagger documentation">​</a></h3><p>The values for the <code>description</code> and <code>notes</code> properties for each route object shift in hapi-swagger&#x27;s autogenerated JSON file:</p><ul><li>the value set for <code>description</code> becomes the value for <code>summary</code></li><li>the value set for <code>notes</code> becomes the value for <code>description</code></li></ul><p>This is important to note, as this affects how our API documentation appears using redocusaurus, please follow the guide above. We are aware this guide does not follow how hapi-swagger outlines how to tag our API routes; however, we are not utilizing hapi-swagger&#x27;s UI to display the documentation page.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/mozilla/ecosystem-platform/edit/master/docs/how-tos/using-swagger-for-api-documentation.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ecosystem-platform/how-tos/using-sentry-locally"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Using Sentry.io for Local Development</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ecosystem-platform/how-tos/using-tracing-in-gcp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tracing for Stage/Prod</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting Started</a></li><li><a href="#how-to-view-locally" class="table-of-contents__link toc-highlight">How to view locally</a></li><li><a href="#api-documentation" class="table-of-contents__link toc-highlight">API documentation</a><ul><li><a href="#tags" class="table-of-contents__link toc-highlight">Tags</a></li><li><a href="#api-documentation-file" class="table-of-contents__link toc-highlight">API documentation file</a></li><li><a href="#adding-api-documentation-to-its-route" class="table-of-contents__link toc-highlight">Adding API documentation to its route</a></li></ul></li><li><a href="#other-information" class="table-of-contents__link toc-highlight">Other information</a><ul><li><a href="#descriptions" class="table-of-contents__link toc-highlight">Descriptions</a></li><li><a href="#hapi-swagger-documentation" class="table-of-contents__link toc-highlight">Hapi-swagger documentation</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Mozilla Corporation.</div></div></div></footer></div>
<script src="/ecosystem-platform/assets/js/runtime~main.2ebd4c4c.js"></script>
<script src="/ecosystem-platform/assets/js/main.87e8bd90.js"></script>
</body>
</html>