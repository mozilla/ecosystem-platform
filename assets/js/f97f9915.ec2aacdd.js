"use strict";(self.webpackChunkfirefox_ecosystem_platform=self.webpackChunkfirefox_ecosystem_platform||[]).push([[377],{1623:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>C,contentTitle:()=>A,default:()=>F,frontMatter:()=>D,metadata:()=>s,toc:()=>E});const s=JSON.parse('{"id":"tutorials/development-setup","title":"Development Setup","description":"Getting Started","source":"@site/docs/tutorials/development-setup.mdx","sourceDirName":"tutorials","slug":"/tutorials/development-setup","permalink":"/ecosystem-platform/tutorials/development-setup","draft":false,"unlisted":false,"editUrl":"https://github.com/mozilla/ecosystem-platform/edit/master/docs/tutorials/development-setup.mdx","tags":[],"version":"current","frontMatter":{"title":"Development Setup"},"sidebar":"docs","previous":{"title":"Using APIs","permalink":"/ecosystem-platform/relying-parties/reference/using-apis"},"next":{"title":"Subscription Platform","permalink":"/ecosystem-platform/tutorials/subscription-platform"}}');var r=t(74848),a=t(28453),o=t(96540),i=t(34164),l=t(17559),c=t(23104),d=t(56347),h=t(205),u=t(57485),p=t(31682),m=t(70679);function g(e){return o.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function x(e){const{values:n,children:t}=e;return(0,o.useMemo)(()=>{const e=n??function(e){return g(e).map(({props:{value:e,label:n,attributes:t,default:s}})=>({value:e,label:n,attributes:t,default:s}))}(t);return function(e){const n=(0,p.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function f({value:e,tabValues:n}){return n.some(n=>n.value===e)}function y({queryString:e=!1,groupId:n}){const t=(0,d.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,u.aZ)(s),(0,o.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})},[s,t])]}function j(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,r=x(e),[a,i]=(0,o.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r})),[l,c]=y({queryString:t,groupId:s}),[d,u]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,m.Dv)(n);return[t,(0,o.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),p=(()=>{const e=l??d;return f({value:e,tabValues:r})?e:null})();(0,h.A)(()=>{p&&i(p)},[p]);return{selectedValue:a,selectValue:(0,o.useCallback)(e=>{if(!f({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);i(e),c(e),u(e)},[c,u,r]),tabValues:r}}var v=t(92303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function w({className:e,block:n,selectedValue:t,selectValue:s,tabValues:a}){const o=[],{blockElementScrollPositionUntilNextRender:l}=(0,c.a_)(),d=e=>{const n=e.currentTarget,r=o.indexOf(n),i=a[r].value;i!==t&&(l(n),s(i))},h=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,r.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:a.map(({value:e,label:n,attributes:s})=>(0,r.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:h,onClick:d,...s,className:(0,i.A)("tabs__item",b.tabItem,s?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function k({lazy:e,children:n,selectedValue:t}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find(e=>e.props.value===t);return e?(0,o.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,r.jsx)("div",{className:"margin-top--md",children:s.map((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function I(e){const n=j(e);return(0,r.jsxs)("div",{className:(0,i.A)(l.G.tabs.container,"tabs-container",b.tabList),children:[(0,r.jsx)(w,{...n,...e}),(0,r.jsx)(k,{...n,...e})]})}function T(e){const n=(0,v.A)();return(0,r.jsx)(I,{...e,children:g(e.children)},String(n))}const S={tabItem:"tabItem_Ymn6"};function N({children:e,hidden:n,className:t}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,i.A)(S.tabItem,t),hidden:n,children:e})}const D={title:"Development Setup"},A=void 0,C={},E=[{value:"Getting Started",id:"getting-started",level:2},{value:"Step 1: Install the system dependencies",id:"step-1-install-the-system-dependencies",level:3},{value:"Step 2: Set up and run the code",id:"step-2-set-up-and-run-the-code",level:3},{value:"Step 3: Optional Additions",id:"step-3-optional-additions",level:3},{value:"Do you need a relying party to test with?",id:"do-you-need-a-relying-party-to-test-with",level:4},{value:"Do you want to test with 3rd party logins (e.g. Apple or Google)?",id:"do-you-want-to-test-with-3rd-party-logins-eg-apple-or-google",level:4},{value:"Do you need the payments services up and running?",id:"do-you-need-the-payments-services-up-and-running",level:4},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Handy commands",id:"handy-commands",level:3},{value:"Testing",id:"testing",level:2},{value:"Run unit tests on all or some packages",id:"run-unit-tests-on-all-or-some-packages",level:3},{value:"Integration Tests",id:"integration-tests",level:3},{value:"Functional Playwright Tests",id:"functional-playwright-tests",level:3},{value:"Emulating a CI environment",id:"emulating-a-ci-environment",level:3},{value:"Contributing",id:"contributing",level:2}];function q(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["\ud83d\udc4b Just a heads up - FxA has a lot of moving parts, and there are plenty of areas that may cause headaches when getting set up. If you get stuck feel free to ",(0,r.jsx)(n.a,{href:"/#lets-chat",children:"reach out"})," and we'll do our best to help."]})}),"\n",(0,r.jsx)(n.h3,{id:"step-1-install-the-system-dependencies",children:"Step 1: Install the system dependencies"}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["Looking for how to manage Yarn dependencies? ",(0,r.jsx)(n.a,{href:"../how-tos/managing-yarn-dependencies",children:"Click here"})," to learn more."]})}),"\n",(0,r.jsx)(n.p,{children:"Select your operating system to install the required dependencies for developing FxA. The instructions are intended to be followed in order."}),"\n",(0,r.jsxs)(T,{groupId:"operating-systems",children:[(0,r.jsxs)(N,{value:"mac",label:"macOS",default:!0,children:[(0,r.jsx)(n.p,{children:"First, we need to install git via XCode.  This will take a few minutes.  Type this in your shell:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"xcode-select --install\n"})}),(0,r.jsx)(n.p,{children:"Then install nvm"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash\n"})}),(0,r.jsx)(n.p,{children:"Next, use the command line to install the following:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# JQ (via brew, for more install options see: https://stedolan.github.io/jq/download/)\nbrew install jq\n"})}),(0,r.jsx)(n.p,{children:"Finally, manually install the following:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://docs.docker.com/desktop/mac/install/",children:"Docker Desktop"})," (required)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://cloud.google.com/sdk/docs/quickstart#mac",children:"Google Cloud SDK CLI"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Instead of ",(0,r.jsx)(n.code,{children:"gcloud init"}),", you may login with ",(0,r.jsx)(n.code,{children:"gcloud auth application-default login"})," to skip project selection"]}),"\n"]}),"\n"]}),"\n"]})]}),(0,r.jsxs)(N,{value:"ubuntu",label:"Ubuntu",children:[(0,r.jsx)(n.p,{children:"Start by installing some essentials:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# Git, curl, libgmp + more\nsudo apt-get install git curl jq build-essential pkg-config libssl-dev libgmp3-dev\n"})}),(0,r.jsxs)(n.p,{children:["Node.js can be installed in a few ways (including using the ",(0,r.jsx)(n.a,{href:"https://nodejs.org/en/download/",children:"installer"}),"). The following commands install the latest version, but you should check out ",(0,r.jsx)(n.a,{href:"https://github.com/mozilla/fxa/blob/main/.nvmrc",children:(0,r.jsx)(n.code,{children:".nvmrc"})})," to see the specific version FxA expects (YMMV using versions greater than it):"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# via nvm (recommended) - https://github.com/nvm-sh/nvm\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash\nnvm install node\n\n# via NodeSource\ncurl -fsSL https://deb.nodesource.com/setup_current.x | sudo -E bash -\nsudo apt-get install -y nodejs\n"})}),(0,r.jsx)(n.p,{children:"With Node + NPM installed you can now install Yarn:"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"npm install -g yarn\n"})}),(0,r.jsx)(n.p,{children:"Finally, manually install the following:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/engine/install/ubuntu/",children:"Docker Desktop"})}),"\n",(0,r.jsxs)(t,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)("summary",{children:"Additional Docker notes"}),"\nDocker commands require sudo, to avoid it, follow steps below:"]}),(0,r.jsxs)(n.p,{children:["Add the ",(0,r.jsx)(n.code,{children:"docker"})," group if it doesn't already exist:"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"sudo groupadd docker\n"})}),(0,r.jsxs)(n.p,{children:["Add the connected user ",(0,r.jsx)(n.code,{children:"$USER"})," to the ",(0,r.jsx)(n.code,{children:"docker"})," group"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"sudo gpasswd -a $USER docker\n"})}),(0,r.jsxs)(n.p,{children:["Restart the ",(0,r.jsx)(n.code,{children:"docker"})," daemon"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"sudo service docker restart\n"})})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://cloud.google.com/sdk/docs/quickstart#deb",children:"Google Cloud SDK CLI"})}),"\n"]}),"\n"]})]}),(0,r.jsxs)(N,{value:"win",label:"Windows",children:[(0,r.jsxs)(n.p,{children:["Start by installing ",(0,r.jsx)(n.a,{href:"https://docs.microsoft.com/en-ca/windows/wsl/",children:"Windows Subsystem for Linux"}),"."]}),(0,r.jsx)(n.p,{children:"Follow the Ubuntu instructions for installing essentials and Node via CLI."}),(0,r.jsx)(n.p,{children:"Finally, manually install the following:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/desktop/windows/install/",children:"Docker Desktop"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://cloud.google.com/sdk/docs/quickstart#windows",children:"Google Cloud SDK CLI"})}),"\n"]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"step-2-set-up-and-run-the-code",children:"Step 2: Set up and run the code"}),"\n",(0,r.jsx)(n.p,{children:"Make sure you're using a new shell if you just installed all the dependencies above.  That will ensure your environment\nis configured properly before we move on to the rest of the steps:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# Clone the repository\ngit clone https://github.com/mozilla/fxa.git\ncd fxa\n\n# Install some packages\nnvm install          # This picks up on the version in .nvmrc and installs the right thing\nnpm install -g yarn  # This installs yarn for the specific version of node you just installed above\nnpm install -g nx\n\n# Initialize the L10n repository\n./_scripts/l10n/clone.sh\n\n## Install the node dependencies\nyarn install\n\n## On first run, generate an openID key\nNODE_ENV=dev yarn workspace fxa-auth-server gen-keys\n\n## Start the project!\nyarn start\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"yarn start"})," starts up ",(0,r.jsx)(n.strong,{children:"all"})," required services via PM2. This includes Redis, MySQL, and Memcached. It is recommended that you don't run these services yourself, or occupy any of the server ports (check out our ",(0,r.jsx)(n.a,{href:"https://github.com/search?type=code&q=repo:mozilla/fxa+filename:pm2.config.js+filename:infrastructure.config.js",children:"PM2 configs"}),"). Doing so may result in errors."]})}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsxs)(n.p,{children:["Additional ",(0,r.jsx)(n.code,{children:"start"})," command options are available to partially start the stack. E.g. ",(0,r.jsx)(n.code,{children:"yarn start mza"})," to start only required Mozilla Accounts services."]}),(0,r.jsxs)(n.p,{children:["For a full list of these commands, run ",(0,r.jsx)(n.code,{children:"yarn nps -h"}),"."]})]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Once your services have all started up you should now be able to ",(0,r.jsx)(n.a,{href:"http://localhost:3030",children:"visit FxA\nlocally"}),". Next up you may want to ",(0,r.jsx)(n.a,{href:"../how-tos/creating-an-account-locally",children:"create an account"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["FxA should only be accessed locally using the ",(0,r.jsx)(n.code,{children:"localhost"})," host, and not via ",(0,r.jsx)(n.code,{children:"127.0.0.1"}),"."]})}),"\n",(0,r.jsx)(n.h3,{id:"step-3-optional-additions",children:"Step 3: Optional Additions"}),"\n",(0,r.jsx)(n.h4,{id:"do-you-need-a-relying-party-to-test-with",children:"Do you need a relying party to test with?"}),"\n",(0,r.jsxs)(n.p,{children:["123done is automatically started with ",(0,r.jsx)(n.code,{children:"yarn start"})," but it won't work until ",(0,r.jsx)(n.a,{href:"https://github.com/mozilla/fxa/blob/main/packages/123done/README.md#running-locally",children:"you finish setting it up"}),".  Talk to someone on the team for the right value to put in the ",(0,r.jsx)(n.code,{children:"packages/123done/secrets.json"})," file."]}),"\n",(0,r.jsx)(n.h4,{id:"do-you-want-to-test-with-3rd-party-logins-eg-apple-or-google",children:"Do you want to test with 3rd party logins (e.g. Apple or Google)?"}),"\n",(0,r.jsxs)(n.p,{children:["Those need ",(0,r.jsx)(n.a,{href:"../reference/third-party-authentication",children:"some additional configuration"}),".  Talk to someone on the team for the right values to put in your ",(0,r.jsx)(n.code,{children:"packages/fxa-auth-server/config/secrets.json"})," file."]}),"\n",(0,r.jsx)(n.h4,{id:"do-you-need-the-payments-services-up-and-running",children:"Do you need the payments services up and running?"}),"\n",(0,r.jsxs)(n.p,{children:["Those need ",(0,r.jsx)(n.a,{href:"../tutorials/subscription-platform",children:"additional configuration"})," also. You'll need to talk to someone on the team for the right values to put in your ",(0,r.jsx)(n.code,{children:"packages/fxa-auth-server/config/secrets.json"})," file."]}),"\n",(0,r.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsxs)(n.p,{children:["If the FxA stack has trouble starting after running ",(0,r.jsx)(n.code,{children:"yarn start"}),', (for example, a process hangs or you don\'t see a success message similar to "# Stack Started Successfully !") try starting without cache:']}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"NX_SKIP_NX_CACHE=true yarn start\n"})}),"\n",(0,r.jsx)(n.p,{children:"Be sure to check the PM2 logs to see what, if any errors are reported.  To do this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"yarn pm2 logs\n"})}),"\n",(0,r.jsx)(n.p,{children:"To get logs from a specific service, add the service name as an argument.  For example, to check auth-server logs:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"yarn pm2 logs auth\n"})}),"\n",(0,r.jsxs)(n.p,{children:["A full log file can also be found at ",(0,r.jsx)(n.code,{children:"~/.pm2/pm2.log"})," and for each service, ",(0,r.jsx)(n.code,{children:"~/.pm2/logs/"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["If a ",(0,r.jsx)(n.code,{children:"NX - Daemon processes terminated and closed the connect"})," error message appears when attempting to start the stack, you may turn off the nx daemon locally by adding this setting to a .env file in fxa root:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"NX_DAEMON=false\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If you encounter errors with auth-server's key server on startup (",(0,r.jsx)(n.code,{children:"Failed to get response from: localhost:9000/__heartbeat__"}),") , you may need to generate an openID key.  You can check to see if it's present at ",(0,r.jsx)(n.code,{children:"packages/fxa-auth-server/config/key.json"}),".  If it's missing, try running:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"NODE_ENV=dev yarn workspace fxa-auth-server gen-keys\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You might also notice auth-server showing errors related to missing ",(0,r.jsx)(n.code,{children:"packages/fxa-auth-server/config/secrets.json"}),".  This shouldn't be required to run, but if you'd like to resolve the errors, ask a team member for their auth secrets.json file."]}),"\n",(0,r.jsx)(n.h3,{id:"handy-commands",children:"Handy commands"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/Unitech/PM2",children:"PM2"})," is used to control services locally. Use the CLI to control and inspect services:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# Start all services\nyarn start\n\n# Stop all services\nyarn stop\n\n# Display logs for all services\nyarn pm2 logs\n\n# Display logs for just the `auth` service\nyarn pm2 logs auth\n\n# Restart the `mysql` service\nyarn pm2 restart mysql\n\n# Stop the `content` service\nyarn pm2 stop content\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Check out the ",(0,r.jsx)(n.a,{href:"https://github.com/Unitech/PM2",children:"PM2 docs"})," for more commands. If\nyou're using VS Code there is also a ",(0,r.jsx)(n.a,{href:"../how-tos/using-vscode-with-fxa",children:"handy extension"})," for managing PM2 services."]}),"\n",(0,r.jsxs)(n.p,{children:["Additionally, be sure to check out the ",(0,r.jsx)(n.a,{href:"https://github.com/mozilla/fxa/search?q=package.json",children:(0,r.jsx)(n.code,{children:"package.json"})})," files in both the root and individual packages to see all available commands."]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:["To avoid wasting computer resources while not working on FxA make sure to stop the servers using ",(0,r.jsx)(n.code,{children:"yarn stop"}),". Once you are back working on FxA just use the ",(0,r.jsx)(n.code,{children:"yarn start"})," command to bring the servers back up."]})}),"\n",(0,r.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"While it is possible to run the entire code base's test suite, in development you'll likely want to run a specific test or a subset of tests. Please refer to each package's documentation for detailed instructions on how to test its respective code."})}),"\n",(0,r.jsx)(n.h3,{id:"run-unit-tests-on-all-or-some-packages",children:"Run unit tests on all or some packages"}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["You might need to run ",(0,r.jsx)(n.code,{children:"yarn start infrastructure"})," to start services before running tests."]})}),"\n",(0,r.jsx)(n.p,{children:"From the root directory you may test all or some FxA packages:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# Test only `fxa-shared`\nyarn test fxa-shared\n\n# Test `fxa-shared` and `fxa-auth-server`\nyarn test fxa-shared fxa-auth-server\n\n# Test all packages\nyarn test all\n"})}),"\n",(0,r.jsx)(n.p,{children:"The above commands invoke the same tests that CI uses, and is not necessarily the same as running yarn test in any given package."}),"\n",(0,r.jsx)(n.h3,{id:"integration-tests",children:"Integration Tests"}),"\n",(0,r.jsx)(n.p,{children:"You may need credentials to pass all tests, e.g. for auth-server or recovery phone tests.  Check 1password or ask a teammate!"}),"\n",(0,r.jsxs)(n.p,{children:["Make sure the the infrastructure stack has been started and is running: ",(0,r.jsx)(n.code,{children:"yarn start infrastructure"}),". From the root directory, run integration tests on some or all FxA packages:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# Test only `fxa-auth-server`\nnx test-integration fxa-auth-server\n\n# Test `fxa-shared` and `fxa-auth-server`\nnx run-many -t test-integration -p fxa-shared fxa-auth-server\n\n# Test `fxa-shared` and `fxa-auth-server` with 5 parallel workers\nnx run-many -t test-integration -p fxa-shared fxa-auth-server --parallel=5\n\n# Test all packages\nnx run-many -t test-integration\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For details and additional commands, try the ",(0,r.jsx)(n.a,{href:"https://nx.dev/reference/nx-commands",children:"NX documentation"})]}),"\n",(0,r.jsx)(n.h3,{id:"functional-playwright-tests",children:"Functional Playwright Tests"}),"\n",(0,r.jsx)(n.p,{children:"You can run functional tests that emulate user behavior. This is a good final pass for any change that affects the UI. It can also save lots of time during development, because running the functional test is quite fast. Note that functional tests are not a replacement for unit tests, so use them judiciously."}),"\n",(0,r.jsxs)(n.p,{children:["Make sure the stack has been started and is running (",(0,r.jsx)(n.code,{children:"yarn start"}),"). From here, there are a few variants:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Run tests in headless mode\nyarn workspace functional-tests test\n\n# Run tests in debug mode allowing step through of each test stage. Note, using the --grep argument\n# or adding .only statements to tests cases is a good idea when debugging, since stepping though every\n# single tests is not desirable.\nyarn workspace functional-tests test --debug --grep=$test_name\n\n# Run tests in debug console mode, allowing browser debugging.\n# https://playwright.dev/docs/debug#selectors-in-developer-tools-console\nPWDEBUG=console yarn workspace functional-tests test\n\n# Target a specific test\nyarn workspace functional-tests test --grep=$test_name\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For more info, see details at ",(0,r.jsx)(n.a,{href:"https://playwright.dev",children:"https://playwright.dev"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"emulating-a-ci-environment",children:"Emulating a CI environment"}),"\n",(0,r.jsxs)(n.p,{children:["It is possible to run various test suites (known as Jobs) acting as CircleCI. This is useful if you're encountering CI-specific failures. Please refer to ",(0,r.jsx)(n.a,{href:"#UPDATE-ME",children:"this documentation"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"contributing",children:"Contributing"}),"\n",(0,r.jsxs)(n.p,{children:["If you've got FxA all set up and running, congratulations! Those interested in helping to develop Mozilla accounts should check out the ",(0,r.jsx)(n.a,{href:"https://github.com/mozilla/fxa/blob/main/CONTRIBUTING.md",children:"Contributing"})," doc."]})]})}function F(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(q,{...e})}):q(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var s=t(96540);const r={},a=s.createContext(r);function o(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);