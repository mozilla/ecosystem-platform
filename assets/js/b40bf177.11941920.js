"use strict";(self.webpackChunkfirefox_ecosystem_platform=self.webpackChunkfirefox_ecosystem_platform||[]).push([[9350],{18430:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"how-tos/managing-yarn-dependencies","title":"Managing Yarn Dependencies","description":"On Your Machine","source":"@site/docs/how-tos/managing-yarn-dependencies.md","sourceDirName":"how-tos","slug":"/how-tos/managing-yarn-dependencies","permalink":"/ecosystem-platform/how-tos/managing-yarn-dependencies","draft":false,"unlisted":false,"editUrl":"https://github.com/mozilla/ecosystem-platform/edit/master/docs/how-tos/managing-yarn-dependencies.md","tags":[],"version":"current","frontMatter":{"title":"Managing Yarn Dependencies"},"sidebar":"docs","previous":{"title":"Local Emails with MailDev","permalink":"/ecosystem-platform/how-tos/local-emails-with-maildev"},"next":{"title":"Node Debugging","permalink":"/ecosystem-platform/how-tos/node-debugging"}}');var s=t(74848),a=t(28453);const i={title:"Managing Yarn Dependencies"},d=void 0,r={},c=[{value:"On Your Machine",id:"on-your-machine",level:2},{value:"Dependabot Pull Requests",id:"dependabot-pull-requests",level:2},{value:"A note about resolutions for sub-dependencies",id:"a-note-about-resolutions-for-sub-dependencies",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"on-your-machine",children:"On Your Machine"}),"\n",(0,s.jsxs)(n.p,{children:["FxA uses ",(0,s.jsx)(n.a,{href:"https://yarnpkg.com/",children:"Yarn"})," to manage its Node dependencies. Follow the ",(0,s.jsx)(n.a,{href:"../tutorials/development-setup",children:"Development Setup guide"})," for how to install Yarn and the ",(0,s.jsx)(n.code,{children:"yarn"})," command on your machine."]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Once upon a time FxA used ",(0,s.jsx)(n.a,{href:"https://docs.npmjs.com/cli/v7/commands/npm",children:(0,s.jsx)(n.code,{children:"npm"})})," to manage its dependencies, which means you may come across documentation or commands that still reference its usage. In most cases you should be able to freely replace the keyword ",(0,s.jsx)(n.code,{children:"npm"})," with ",(0,s.jsx)(n.code,{children:"yarn"}),", but it's worth learning about ",(0,s.jsx)(n.a,{href:"https://www.sitepoint.com/yarn-vs-npm/#comparingnpmandyarncommands",children:"the differences"})," between the two CLIs."]})}),"\n",(0,s.jsxs)(n.p,{children:["We have a ",(0,s.jsx)(n.em,{children:"lot"})," of dependencies, and they're constantly updating, so be sure to occasionally run ",(0,s.jsx)(n.code,{children:"yarn install"})," to stay up-to-date."]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"yarn install"})," is failing run ",(0,s.jsx)(n.code,{children:"yarn -v"})," and check that it is at least 1.22.0. Run ",(0,s.jsx)(n.code,{children:"npm install -g yarn"})," to update to the latest version if needed."]})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["We have a script that can automatically detect changes to the ",(0,s.jsx)(n.code,{children:"yarn.lock"})," file and run ",(0,s.jsx)(n.code,{children:"yarn install"})," when you check out a branch or pull in latest. To enable it set ",(0,s.jsx)(n.code,{children:"FXA_AUTO_INSTALL=1"}),".  If you don't enable it, you'll see a warning when changes are detected letting you know to run ",(0,s.jsx)(n.code,{children:"yarn install"})," manually."]})}),"\n",(0,s.jsx)(n.h2,{id:"dependabot-pull-requests",children:"Dependabot Pull Requests"}),"\n",(0,s.jsxs)(n.p,{children:["We use GitHub's ",(0,s.jsx)(n.a,{href:"https://docs.github.com/en/code-security/supply-chain-security/keeping-your-dependencies-updated-automatically/about-dependabot-version-updates",children:"Dependabot"})," to automatically update our dependencies."]}),"\n",(0,s.jsxs)(n.p,{children:["It ",(0,s.jsx)(n.a,{href:"https://github.com/mozilla/fxa/blob/main/.github/dependabot.yml",children:"runs daily"}),", opening Pull Requests whenever a update is available for any of our many packages' dependencies. PRs will automatically request a review from the ",(0,s.jsx)(n.code,{children:"@mozilla/fxa-devs"})," GitHub group. FxA engineers are expected to occasionally pitch in with reviewing and merging these PRs."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/mozilla/fxa/pulls?q=is:pr+is:open+sort:updated-desc+author:app/dependabot",children:"Click here"})," to see all open Dependabot PRs."]}),"\n",(0,s.jsx)(n.h2,{id:"a-note-about-resolutions-for-sub-dependencies",children:"A note about resolutions for sub-dependencies"}),"\n",(0,s.jsxs)(n.p,{children:["Resolutions may not work for sub-dependencies. If adding a resolution for a dependency in ",(0,s.jsx)(n.code,{children:"package.json"})," is not picked up by ",(0,s.jsx)(n.code,{children:"yarn.lock"}),", you might need to set the resolution manually (this will need to be done for each installed version of the dependency that needs to be resolved)."]}),"\n",(0,s.jsx)(n.p,{children:"This generally happens when a dependency has not updated one of it's sub-dependencies, and we would like to force an update for that sub-dependency in our project."}),"\n",(0,s.jsxs)(n.p,{children:["For example, if ",(0,s.jsx)(n.code,{children:"yarn.lock"})," has ",(0,s.jsx)(n.code,{children:"package@npm:1.1.1, package@npm:^1.2.0"})," and the dependency needs to be resolved to ",(0,s.jsx)(n.code,{children:"1.3.0"}),", 2 commands will need to be run (with 'package' here replaced with the name of the dependency that needs to be resolved):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"yarn set resolution package@npm:1.1.1 '>1.3.0'\nyarn set resolution package@npm:^1.2.0 '>1.3.0'\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>d});var o=t(96540);const s={},a=o.createContext(s);function i(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);