"use strict";(self.webpackChunkfirefox_ecosystem_platform=self.webpackChunkfirefox_ecosystem_platform||[]).push([[2001],{26213:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var o=i(74848),n=i(28453);const s={title:"Tracing for Stage/Prod"},r="Tracing on Stage / Prod",a={id:"how-tos/using-tracing-in-gcp",title:"Tracing for Stage/Prod",description:"At the time of writing we are still applying the configurations to various services, but inevitably all services will be configured. Currently the auth server has been configured to work on staging.",source:"@site/docs/how-tos/using-tracing-in-gcp.md",sourceDirName:"how-tos",slug:"/how-tos/using-tracing-in-gcp",permalink:"/ecosystem-platform/how-tos/using-tracing-in-gcp",draft:!1,unlisted:!1,editUrl:"https://github.com/mozilla/ecosystem-platform/edit/master/docs/how-tos/using-tracing-in-gcp.md",tags:[],version:"current",frontMatter:{title:"Tracing for Stage/Prod"},sidebar:"docs",previous:{title:"Using Swagger for API documentation",permalink:"/ecosystem-platform/how-tos/using-swagger-for-api-documentation"},next:{title:"Tracing for Local Development",permalink:"/ecosystem-platform/how-tos/using-tracing-locally"}},c={},l=[{value:"Viewing Traces in Google Cloud Trace",id:"viewing-traces-in-google-cloud-trace",level:2},{value:"Seeing performance statistics",id:"seeing-performance-statistics",level:2},{value:"Correlating Logs",id:"correlating-logs",level:2}];function g(e){const t={a:"a",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",...(0,n.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"tracing-on-stage--prod",children:"Tracing on Stage / Prod"})}),"\n",(0,o.jsx)(t.p,{children:"At the time of writing we are still applying the configurations to various services, but inevitably all services will be configured. Currently the auth server has been configured to work on staging."}),"\n",(0,o.jsxs)(t.p,{children:["The primary difference between using tracing locally and on stage/production is that traces on stage/production will be viewed in ",(0,o.jsx)(t.a,{href:"https://console.cloud.google.com/traces/list",children:"google cloud trace viewer"})," instead of Jaeger. The other notable difference is that the sample rate will be much lower."]}),"\n",(0,o.jsx)(t.p,{children:"This means you should not count on every request made to show up. Only a subset of requests will be captured. If you need tracing, and aren't seeing the trace you need, reach out to the team. We might need to adjust the sampling configuration, so the trace you need is more likely to come through."}),"\n",(0,o.jsx)(t.h2,{id:"viewing-traces-in-google-cloud-trace",children:"Viewing Traces in Google Cloud Trace"}),"\n",(0,o.jsxs)(t.p,{children:["To start exploring traces go to the ",(0,o.jsx)(t.a,{href:"https://console.cloud.google.com/traces/list",children:"google cloud trace viewer"}),"."]}),"\n",(0,o.jsx)(t.p,{children:"Next try the following filters:"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["Search by trace id\n",(0,o.jsx)(t.img,{alt:"graph view",src:i(13049).A+"",title:"image_tooltip",width:"994",height:"587"})]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["Filter by http method\n",(0,o.jsx)(t.img,{alt:"graph view",src:i(45107).A+"",title:"image_tooltip",width:"1006",height:"248"})]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["Filter by route / target\n",(0,o.jsx)(t.img,{alt:"graph view",src:i(81219).A+"",title:"image_tooltip",width:"999",height:"299"})]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"seeing-performance-statistics",children:"Seeing performance statistics"}),"\n",(0,o.jsxs)(t.p,{children:["Tracing also gives a rough idea of service performance. It's good to know that there are some automatically generated reports. These can be found under the ",(0,o.jsx)(t.a,{href:"https://console.cloud.google.com/traces/tasks?project=moz-fx-fxa-nonprod-375e",children:"analysis reports tab"}),". At the time of writing, these reports still need quite a bit of work to be useful."]}),"\n",(0,o.jsx)(t.h2,{id:"correlating-logs",children:"Correlating Logs"}),"\n",(0,o.jsx)(t.p,{children:"One final thing that's nice to have with tracing is the ability to see related log messages. In google cloud trace, you'll notice a link to view logs."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"graph view",src:i(39076).A+"",title:"image_tooltip",width:"429",height:"137"})}),"\n",(0,o.jsxs)(t.p,{children:["This will bring up a view of the time slice that the trace fills.\n",(0,o.jsx)(t.img,{alt:"graph view",src:i(80117).A+"",title:"image_tooltip",width:"1714",height:"285"})]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.em,{children:"Note, that in the future, you should also be able to search for the traceId. For some reason this isn't coming through on log messages at the moment."})})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(g,{...e})}):g(e)}},45107:(e,t,i)=>{i.d(t,{A:()=>o});const o=i.p+"assets/images/tracing-gcp-filter-by-method-812f755e58a11492722cab74764da85d.png"},81219:(e,t,i)=>{i.d(t,{A:()=>o});const o=i.p+"assets/images/tracing-gcp-filter-by-target-29320a85a24ad4f9263ee16ecec3913f.png"},80117:(e,t,i)=>{i.d(t,{A:()=>o});const o=i.p+"assets/images/tracing-gcp-log-viewer-trace-slice-11a132956ae579d82267afdc195ca946.png"},13049:(e,t,i)=>{i.d(t,{A:()=>o});const o=i.p+"assets/images/tracing-gcp-search-by-trace-id-a4ff05c79223f93acaccb94a23250423.png"},39076:(e,t,i)=>{i.d(t,{A:()=>o});const o=i.p+"assets/images/tracing-gcp-trace-logs-view-218a05af2944cd45973d09095e6c880b.png"},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>a});var o=i(96540);const n={},s=o.createContext(n);function r(e){const t=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),o.createElement(s.Provider,{value:t},e.children)}}}]);