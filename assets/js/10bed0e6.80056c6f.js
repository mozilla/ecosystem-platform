"use strict";(self.webpackChunkfirefox_ecosystem_platform=self.webpackChunkfirefox_ecosystem_platform||[]).push([[9074],{28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var o=n(96540);const r={},s=o.createContext(r);function i(e){const t=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:t},e.children)}},87791:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"how-tos/using-sentry-locally","title":"Using Sentry.io for Local Development","description":"FxA uses sentry.io to monitor errors and performance in production / staging. FxA developers can also use sentry.io during local development. Here are a few scenarios where enabling sentry locally might be helpful:","source":"@site/docs/how-tos/using-sentry-locally.md","sourceDirName":"how-tos","slug":"/how-tos/using-sentry-locally","permalink":"/ecosystem-platform/how-tos/using-sentry-locally","draft":false,"unlisted":false,"editUrl":"https://github.com/mozilla/ecosystem-platform/edit/master/docs/how-tos/using-sentry-locally.md","tags":[],"version":"current","frontMatter":{"title":"Using Sentry.io for Local Development"},"sidebar":"docs","previous":{"title":"Using a Custom Profile with Firefox","permalink":"/ecosystem-platform/how-tos/using-a-custom-profile-with-firefox"},"next":{"title":"Using Swagger for API documentation","permalink":"/ecosystem-platform/how-tos/using-swagger-for-api-documentation"}}');var r=n(74848),s=n(28453);const i={title:"Using Sentry.io for Local Development"},a=void 0,l={},c=[];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.p,{children:["FxA uses ",(0,r.jsx)(t.a,{href:"https://sentry.io",children:"sentry.io"})," to monitor errors and performance in production / staging. FxA developers can also use ",(0,r.jsx)(t.a,{href:"https://sentry.io",children:"sentry.io"})," during local development. Here are a few scenarios where enabling sentry locally might be helpful:"]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Validating that an error reproduced locally aligns with an error reported in staging or production."}),"\n",(0,r.jsx)(t.li,{children:"Auditing performance / errors after exploratory testing, functional testing, or a load test."}),"\n",(0,r.jsx)(t.li,{children:"Gaining a better understanding of calls made by a certain workflow or endpoint."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["To enable sentry for local development, simply set these environment variables in your root-level ",(0,r.jsx)(t.code,{children:".env"})," file (that you may need to create) to their respective DSN settings. When these variables are defined, sentry will be activated."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"SENTRY_ENV=local\nSENTRY_DSN_ADMIN_PANEL=\nSENTRY_DSN_AUTH=\nSENTRY_DSN_CONTENT=\nSENTRY_DSN_CUSTOMS=\nSENTRY_DSN_EVENT_BROKER=\nSENTRY_DSN_GRAPHQL_API=\nSENTRY_DSN_PAYMENTS=\nSENTRY_DSN_PROFILE=\nSENTRY_DSN_SUPPPORT_PANEL=\nSENTRY_DSN_BROWSERID=\n"})}),"\n",(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsxs)(t.p,{children:["DSN settings can be found by going to sentry.io, navigating to the project's ",(0,r.jsx)(t.em,{children:"settings"}),", and selecting ",(0,r.jsx)(t.em,{children:"client keys"}),". For example, the setting for SENTRY_DSN_ADMIN_PANEL can be found ",(0,r.jsx)(t.a,{href:"https://sentry.io/settings/mozilla/projects/fxa-admin-panel/keys/",children:"here"}),"."]})}),"\n",(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsx)(t.p,{children:"Each variable name links to the sentry.io page containing the DSN value you need to set. Asking a fellow engineer for a copy-and-paste of the environment variables and their values might be the fastest route though..."})}),"\n",(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsx)(t.p,{children:"It's totally acceptable to only specify the DSN values for the projects you care about."})}),"\n",(0,r.jsxs)(t.p,{children:["Once the local environment is configured, stop and start the FxA stack and proceed with exploratory testing. Then go to ",(0,r.jsx)(t.a,{href:"https://sentry.io",children:"sentry.io"}),", log in with SSO, and ",(0,r.jsx)(t.a,{href:"https://docs.sentry.io/product/sentry-basics/environments/",children:"filter to the local environment"}),". Performance stats and errors from your system will be visible. It may take several minutes for the error to propagate, so if you don't see the error and are confident the configuration is good, check back later."]}),"\n",(0,r.jsx)(t.p,{children:"Keep in mind that developers share the local environment in sentry, so it\u2019s best practice to leave these DSN environment variables undefined when sentry is not actively being used. Doing so will reduce noise in the sentry 'local' environment and make the developer experience better for those who are actively using sentry."}),"\n",(0,r.jsxs)(t.p,{children:["To easily enable / disable sentry for local development, defining the SENTRY_DSN_* environment variables in the .env file in the root of FXA is a good approach. This file is git ignored, so the settings won\u2019t accidentally get leaked, and the ",(0,r.jsx)(t.a,{href:"https://www.npmjs.com/package/dotenv-cli",children:"dotenv-cli"})," utility makes managing this trivial. ",(0,r.jsx)(t.em,{children:"You must install dotenv-cli globally for this to work!"})," Here\u2019s a quick example of temporarily running the FxA stack with sentry enabled via the .env file."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"# Double check that the .env file has the proper SENTRY_DSN_* values configured.\ncat .env\n\n# Make sure dev stack has been stopped. PM2 pulls in env state on start, not restart.\nyarn stop\n\n# Start the stack with the .env file applied.\ndotenv -- yarn start \n"})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);